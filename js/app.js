/*!
 * CSVParser.js
 * Mr-Data-Converter
 *
 * Input CSV or Tab-delimited data and this will parse it into a Data Grid Javascript object
 */
function DataConverter(n){this.nodeId=n;this.node=$("#"+n);this.outputDataType="json";this.rowDelimiter="\n";this.inputText="";this.outputText="";this.indent="  ";this.tableName="MrDataConverter";this.headersProvided=!0;this.downcaseHeaders=!1;this.upcaseHeaders=!1;this.includeWhiteSpace=!0;this.useTabsForIndent=!1}var isDecimalRe=/^\s*(\+|-)?((\d+([,\.]\d+)?)|([,\.]\d+))\s*$/,CSVParser={escapeText:function(n,t){return n===undefined?"":(t===undefined&&(t="html"),t==="xml"&&(n=n.replace(/&/g,"&amp;"),n=n.replace(/'/g,"&apos;")),t==="rtf"?(n=n.replace(/\\/g,"\\'5c"),n=n.replace(/\{/g,"\\'7b"),n=n.replace(/\}/g,"\\'7d"),n=n.replace(/~/g,"\\'98")):(n=n.replace(/</g,"&lt;"),n=n.replace(/>/g,"&gt;")),n=n.replace(/…/g,t==="rtf"?"\\'85":"&hellip;"),n=n.replace(/‘/g,t==="rtf"?"\\'91":"&lsquo;"),n=n.replace(/’/g,t==="rtf"?"\\'92":"&rsquo;"),n=n.replace(/“/g,t==="rtf"?"\\'93":"&ldquo;"),n=n.replace(/”/g,t==="rtf"?"\\'94":"&rdquo;"),n=n.replace(/–/g,t==="rtf"?"\\'96":"&ndash;"),n=n.replace(/—/g,t==="rtf"?"\\'97":"&mdash;"),n=n.replace(/‹/g,t==="rtf"?"\\'8b":"&lsaquo;"),n=n.replace(/›/g,t==="rtf"?"\\'9b":"&rsaquo;"),n=n.replace(/«/g,t==="rtf"?"\\'ab":"&laquo;"),n=n.replace(/»/g,t==="rtf"?"\\'bb":"&raquo;"),n=n.replace(/¡/g,t==="rtf"?"\\'a1":"&iexcl;"),n=n.replace(/¿/g,t==="rtf"?"\\'bf":"&iquest;"),n=n.replace(/ /g,t==="rtf"?"\\~":"&nbsp;"),n=n.replace(/€/g,t==="rtf"?"\\'80":"&euro;"),n=n.replace(/†/g,t==="rtf"?"\\'86":"&dagger;"),n=n.replace(/‡/g,t==="rtf"?"\\'87":"&Dagger;"),n=n.replace(/•/g,t==="rtf"?"\\'95":"&bull;"),n=n.replace(/™/g,t==="rtf"?"\\'99":"&trade;"),n=n.replace(/¢/g,t==="rtf"?"\\'a2":"&cent;"),n=n.replace(/£/g,t==="rtf"?"\\'a3":"&pound;"),n=n.replace(/¤/g,t==="rtf"?"\\'a4":"&curren;"),n=n.replace(/¥/g,t==="rtf"?"\\'a5":"&yen;"),n=n.replace(/§/g,t==="rtf"?"\\'a7":"&sect;"),n=n.replace(/©/g,t==="rtf"?"\\'a9":"&copy;"),n=n.replace(/®/g,t==="rtf"?"\\'ae":"&reg;"),n=n.replace(/°/g,t==="rtf"?"\\'b0":"&deg;"),n=n.replace(/±/g,t==="rtf"?"\\'b1":"&plusmn;"),n=n.replace(/²/g,t==="rtf"?"\\'b2":"&sup2;"),n=n.replace(/³/g,t==="rtf"?"\\'b3":"&sup3;"),n=n.replace(/µ/g,t==="rtf"?"\\'b5":"&micro;"),n=n.replace(/¶/g,t==="rtf"?"\\'b6":"&para;"),n=n.replace(/·/g,t==="rtf"?"\\'b7":"&middot;"),n=n.replace(/¼/g,t==="rtf"?"\\'bc":"&frac14;"),n=n.replace(/½/g,t==="rtf"?"\\'bd":"&frac12;"),n=n.replace(/¾/g,t==="rtf"?"\\'be":"&frac34;"),n=n.replace(/×/g,t==="rtf"?"\\'d7":"&times;"),n=n.replace(/÷/g,t==="rtf"?"\\'f7":"&divide;"),n=n.replace(/á/g,t==="rtf"?"\\'e1":"&aacute;"),n=n.replace(/Á/g,t==="rtf"?"\\'c1":"&Aacute;"),n=n.replace(/à/g,t==="rtf"?"\\'e0":"&agrave;"),n=n.replace(/À/g,t==="rtf"?"\\'c0":"&Agrave;"),n=n.replace(/â/g,t==="rtf"?"\\'e2":"&acirc;"),n=n.replace(/Â/g,t==="rtf"?"\\'c2":"&Acirc;"),n=n.replace(/ä/g,t==="rtf"?"\\'e4":"&auml;"),n=n.replace(/Ä/g,t==="rtf"?"\\'c4":"&Auml;"),n=n.replace(/ã/g,t==="rtf"?"\\'e3":"&atilde;"),n=n.replace(/Ã/g,t==="rtf"?"\\'c3":"&Atilde;"),n=n.replace(/å/g,t==="rtf"?"\\'e5":"&aring;"),n=n.replace(/Å/g,t==="rtf"?"\\'c5":"&Aring;"),n=n.replace(/æ/g,t==="rtf"?"\\'e6":"&aelig;"),n=n.replace(/Æ/g,t==="rtf"?"\\'c6":"&AElig;"),n=n.replace(/ç/g,t==="rtf"?"\\'e7":"&ccedil;"),n=n.replace(/Ç/g,t==="rtf"?"\\'c7":"&Ccedil;"),n=n.replace(/ð/g,t==="rtf"?"\\'f0":"&eth;"),n=n.replace(/Ð/g,t==="rtf"?"\\'d0":"&ETH;"),n=n.replace(/é/g,t==="rtf"?"\\'e9":"&eacute;"),n=n.replace(/É/g,t==="rtf"?"\\'c9":"&Eacute;"),n=n.replace(/è/g,t==="rtf"?"\\'e8":"&egrave;"),n=n.replace(/È/g,t==="rtf"?"\\'c8":"&Egrave;"),n=n.replace(/ê/g,t==="rtf"?"\\'ea":"&ecirc;"),n=n.replace(/Ê/g,t==="rtf"?"\\'ca":"&Ecirc;"),n=n.replace(/ë/g,t==="rtf"?"\\'eb":"&euml;"),n=n.replace(/Ë/g,t==="rtf"?"\\'cb":"&Euml;"),n=n.replace(/í/g,t==="rtf"?"\\'ed":"&iacute;"),n=n.replace(/Í/g,t==="rtf"?"\\'cd":"&Iacute;"),n=n.replace(/ì/g,t==="rtf"?"\\'ec":"&igrave;"),n=n.replace(/Ì/g,t==="rtf"?"\\'cc":"&Igrave;"),n=n.replace(/î/g,t==="rtf"?"\\'ee":"&icirc;"),n=n.replace(/Î/g,t==="rtf"?"\\'ce":"&Icirc;"),n=n.replace(/ï/g,t==="rtf"?"\\'ef":"&iuml;"),n=n.replace(/Ï/g,t==="rtf"?"\\'cf":"&Iuml;"),n=n.replace(/ñ/g,t==="rtf"?"\\'f1":"&ntilde;"),n=n.replace(/Ñ/g,t==="rtf"?"\\'d1":"&Ntilde;"),n=n.replace(/ó/g,t==="rtf"?"\\'f3":"&oacute;"),n=n.replace(/Ó/g,t==="rtf"?"\\'d3":"&Oacute;"),n=n.replace(/ò/g,t==="rtf"?"\\'f2":"&ograve;"),n=n.replace(/Ò/g,t==="rtf"?"\\'d2":"&Ograve;"),n=n.replace(/ô/g,t==="rtf"?"\\'f4":"&ocirc;"),n=n.replace(/Ô/g,t==="rtf"?"\\'d4":"&Ocirc;"),n=n.replace(/ö/g,t==="rtf"?"\\'f6":"&ouml;"),n=n.replace(/Ö/g,t==="rtf"?"\\'d6":"&Ouml;"),n=n.replace(/õ/g,t==="rtf"?"\\'f5":"&otilde;"),n=n.replace(/Õ/g,t==="rtf"?"\\'d5":"&Otilde;"),n=n.replace(/ø/g,t==="rtf"?"\\'f8":"&oslash;"),n=n.replace(/Ø/g,t==="rtf"?"\\'d8":"&Oslash;"),n=n.replace(/œ/g,t==="rtf"?"\\'9c":"&#339;"),n=n.replace(/Œ/g,t==="rtf"?"\\'8c":"&#338;"),n=n.replace(/ß/g,t==="rtf"?"\\'df":"&szlig;"),n=n.replace(/ú/g,t==="rtf"?"\\'fa":"&uacute;"),n=n.replace(/Ú/g,t==="rtf"?"\\'da":"&Uacute;"),n=n.replace(/ù/g,t==="rtf"?"\\'f9":"&ugrave;"),n=n.replace(/Ù/g,t==="rtf"?"\\'d9":"&Ugrave;"),n=n.replace(/û/g,t==="rtf"?"\\'fb":"&ucirc;"),n=n.replace(/Û/g,t==="rtf"?"\\'db":"&Ucirc;"),n=n.replace(/ü/g,t==="rtf"?"\\'fc":"&uuml;"),n=n.replace(/Ü/g,t==="rtf"?"\\'dc":"&Uuml;"),n=n.replace(/ý/g,t==="rtf"?"\\'fd":"&yacute;"),n=n.replace(/Ý/g,t==="rtf"?"\\'dd":"&Yacute;"),n=n.replace(/ÿ/g,t==="rtf"?"\\'ff":"&yuml;"),n=n.replace(/Ÿ/g,t==="rtf"?"\\'9f":"&#376;"),n=n.replace(/´/g,t==="rtf"?"\\'b4":"&acute;"),t!=="rtf"&&(n=n.replace(/`/g,"&#96;")),n)},isNumber:function(n){return n!==""&&!(isNaN(n)||/^0\d/.test(n))},repeat:function(n,t){if(t<1)return"";for(var i="";t>1;)t&1&&(i+=n),t>>=1,n+=n;return i+n},parse:function(n,t,i,r,u,f){var o=[],l=new RegExp("[^,]","gi"),b=n.replace(l,"").length,y,a,c,g,nt,e,v,h;for(l=new RegExp("[^\t]","gi"),y=n.replace(l,"").length,a=",",y>b&&(a="\t"),i==="comma"?a=",":i==="tab"&&(a="\t"),(b>0||y>0)&&(l=new RegExp("^"+d.rowDelimiter+"+","gi"),n=n.replace(l,""),l=new RegExp(d.rowDelimiter+"+$","gi"),n=n.replace(l,"")),o=this.CSVToArray(n,a),e=o.length-1;e>=0;--e)for(c=o[e].length-1;c>=0;--c)o[e][c]=o[e][c].replace("\t","\\t"),o[e][c]=o[e][c].replace("\n","\\n"),o[e][c]=o[e][c].replace("\r","\\r");var s=[],p=[],k=o[0].length,rt=o.length;if(t)s=o.splice(0,1)[0],rt=o.length;else for(e=0;e<k;++e)s.push("val"+e),p.push("");for(e=s.length-1;e>=0;--e)s[e]=$.trim(s[e]),s[e]=s[e].replace(/[^\w -]|&quot;/g,""),s[e]=s[e].replace(/ +/g,"_"),/^[^a-z]/i.test(s[e])&&(s[e]="col"+s[e]),u&&(s[e]=s[e].toUpperCase()),r&&(s[e]=s[e].toLowerCase());for(e=0,v=o.length;e<v;++e)g=o[e].length,g!==k&&this.log("Error parsing row "+e+". Wrong number of columns.");for(nt=o.length,e=0,v=s.length;e<v;++e){var tt=0,it=0,w=0;for(h=0;h<nt;++h)o[h]&&(f==="comma"&&isDecimalRe.test(o[h][e])&&(o[h][e]=o[h][e].replace(",",".")),CSVParser.isNumber(o[h][e])?(++it,(o[h][e]+"").indexOf(".")>-1&&++w):o[h][e]!==""&&++tt);p[e]=tt||!it&&!w?"string":w===0?"int":"float"}return{dataGrid:o,headerNames:s,headerTypes:p,errors:this.getLog()}},errorLog:[],resetLog:function(){this.errorLog=[]},log:function(n){this.errorLog.push(n)},getLog:function(){var t="",n,i;if(this.errorLog.length>0){for(n=0,i=this.errorLog.length;n<i;++n)t+="!!"+this.errorLog[n]+"!!\n";t+="\n"}return t},CSVToArray:function(n,t){var u,f;t=t||",";var e=new RegExp("(\\"+t+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+t+"\\r\\n]*))","gi"),r=[[]],i=null;for(t==="\t"&&(n=n.replace(/(\t|\r?\n|\r|^)(".+?")([\t\n\r])/g,function(n,t,i,r){return t+i.replace(/\t/g,"\\t")+r}),n=n.replace(/(\t|\r?\n|\r|^)([^\t"][^\t]+)/g,function(n,t,i){return t+i.replace(/"/g,"&quot;")}));i=e.exec(n);)u=i[1],u.length&&u!==t&&r.push([]),f=i[2]?i[2].replace(/""/g,"&quot;"):i[3],r[r.length-1].push(f);return r}},DataGridRenderer,d;
/*!
 * DataGridRenderer.js
 * Part of Mr-Data-Converter
 *
 * Created by Shan Carter on 2010-10-18.
 */
DataGridRenderer={asp:function(r,e,a,t,n){var l="",o=r.length,v=e.length;n=n||":";for(var f=0;o>f;++f)for(var s=r[f],c=0;v>c;++c){if("int"===a[c]||"float"===a[c])var i=s[c]||"Empty";else var i='"'+(s[c]||"")+'"';l+="myArray("+c+","+f+") = "+i+n}return l="Dim myArray("+(c-1)+","+(f-1)+")"+n+l,l=l.replace(/&quot;/g,'""')},csharp:function(r,e,a,t,n){var l="",o=r.length,v=e.length;l+="DataTable "+d.tableName+" = new DataTable();"+n;for(var f=0;v>f;++f)l+=d.tableName+'.Columns.Add("'+e[f]+'", typeof('+("int"===a[f]||"float"===a[f]?a[f]:"string")+"));"+n;for(var s=0;o>s;++s){var c=r[s];l+=d.tableName+".Rows.Add(";for(var f=0;v>f;++f)l+="int"===a[f]||"float"===a[f]?c[f]||"null":'"'+(c[f]||"")+'"',v-1>f&&(l+=", ");l+=");"+n}return l=l.replace(/&quot;/g,'\\"')},cfml:function(r,e,a,t,n){for(var l="[",o=r.length,v=e.length,f=0;o>f;++f){var s=r[f];l+="{";for(var c=0;v>c;++c){if("int"===a[c]||"float"===a[c])var i=s[c]||'""';else var i='"'+(s[c]||"")+'"';l+='"'+e[c]+'"='+i,v-1>c&&(l+=",")}l+="}",o-1>f&&(l+=","+n)}return l+="]"+n,l=l.replace(/&quot;/g,'\\"')},go:function(r,e,a,t,n){var l="",o=r.length,v=e.length;l+="type rows struct{";for(var f=0;v>f;++f)l+=e[f]+" "+("int"===a[f]||"float"===a[f]?a[f]+"64":"string"),v-1>f&&(l+="; ");l+="}"+(n||";")+d.tableName+" := []rows{"+n;for(var s=0;o>s;++s){var c=r[s];l+=t+"{";for(var f=0;v>f;++f)l+="int"===a[f]||"float"===a[f]?c[f]||"nil":'"'+(c[f]||"")+'"',v-1>f&&(l+=", ");l+="},"+n}return l+="}"+n,l=l.replace(/&quot;/g,'\\"')},html:function(r,e,a,t,n){var l="",o=r.length,v=e.length;l+="<table>"+n+t+"<thead>"+n+t+t+"<tr>"+n;for(var f=0;v>f;++f)l+=t+t+t+'<th class="cell-'+e[f].replace(/_/g,"-").toLowerCase()+'">'+e[f]+"</th>"+n;l+=t+t+"</tr>"+n+t+"</thead>"+n+t+"<tbody>"+n;for(var s=0;o>s;++s){var c=r[s],i="";s===o-1?i=' class="last-row"':0===s&&(i=' class="first-row"'),l+=t+t+"<tr"+i+">"+n;for(var f=0;v>f;++f)l+=t+t+t+'<td class="cell-'+e[f].replace(/_/g,"-").toLowerCase()+'">'+CSVParser.escapeText(c[f])+"</td>"+n;l+=t+t+"</tr>"+n}return l+=t+"</tbody>"+n+"</table>"+n,l=l.replace(/&quot;/g,'"')},json:function(r,e,a,t,n){for(var l="[",o=r.length,v=e.length,f=0;o>f;++f){var s=r[f];l+="{";for(var c=0;v>c;++c){if("int"===a[c]||"float"===a[c])var i=s[c]||"null";else var i='"'+(s[c]||"")+'"';l+='"'+e[c]+'":'+i,v-1>c&&(l+=",")}l+="}",o-1>f&&(l+=","+n)}return l+="]"+n,l=l.replace(/&quot;/g,'\\"')},jsonArrayCols:function(r,e,a,t,n){for(var l="{"+n,o=r.length,v=e.length,f=0;v>f;++f){l+=t+'"'+e[f]+'":[';for(var s=0;o>s;++s)l+="int"===a[f]||"float"===a[f]?r[s][f]||"null":'"'+(r[s][f]||"")+'"',o-1>s&&(l+=",");l+="]",v-1>f&&(l+=","+n)}return l+=n+"}"+n,l=l.replace(/&quot;/g,'\\"')},jsonArrayRows:function(r,e,a,t,n){for(var l="["+n,o=r.length,v=e.length,f=0;o>f;++f){l+=t+"[";for(var s=0;v>s;++s)l+="int"===a[s]||"float"===a[s]?r[f][s]||"null":'"'+(r[f][s]||"")+'"',v-1>s&&(l+=",");l+="]",o-1>f&&(l+=","+n)}return l+=n+"]"+n,l=l.replace(/&quot;/g,'\\"')},jsonDict:function(r,e,a,t,n){for(var l="{"+n,o=r.length,v=e.length,f=function(e,t){return"int"===a[t]||"float"===a[t]?r[e][t]||"null":'"'+(r[e][t]||"")+'"'},s=0;o>s;++s){if(l+=t+'"'+r[s][0]+'":',2===v)l+=f(s,1);else{l+="{";for(var c=1;v>c;++c)c>1&&(l+=","),l+='"'+e[c]+'":'+f(s,c);l+="}"}o-1>s&&(l+=","+n)}return l+=n+"}"+n,l=l.replace(/&quot;/g,'\\"')},luaDict:function(r,e,a,t,n){for(var l="{"+n,o=r.length,v=e.length,f=function(e,t){return"int"===a[t]||"float"===a[t]?r[e][t]||"nil":'"'+(r[e][t]||"")+'"'},s=0;o>s;++s){if(l+=t+'["'+r[s][0]+'"]=',2===v)l+=f(s,1);else{l+="{";for(var c=1;v>c;++c)c>1&&(l+=","),l+='["'+e[c]+'"]='+f(s,c);l+="}"}o-1>s&&(l+=","+n)}return l+=n+"}"+n,l=l.replace(/&quot;/g,'\\"')},luaArray:function(r,e,a,t,n){for(var l="{"+n,o=r.length,v=e.length,f=0;o>f;++f){var s=r[f];l+=t+"["+(f+1)+"]={";for(var c=0;v>c;++c){if("int"===a[c]||"float"===a[c])var i=s[c]||"nil";else var i='"'+(s[c]||"")+'"';l+='["'+e[c]+'"]='+i,v-1>c&&(l+=",")}l+="}",o-1>f&&(l+=","+n)}return l+=n+"}"+n,l=l.replace(/&quot;/g,'\\"')},markdown:function(r,e,a,t,n){var l="",o=r.length,v=e.length,f=[];l+="|";for(var s=0;v>s;++s)l+=" "+e[s]+" |",f.push(e[s].length+2+("int"===a[s]||"float"===a[s]?"r":""));l+=n+"|";for(var s=0;v>s;++s)l+=(f[s].indexOf("r")<0?CSVParser.repeat("-",f[s]):CSVParser.repeat("-",parseInt(f[s])-1)+":")+"|";for(var c=0;o>c;++c){var i=r[c];l+=n+"|";for(var s=0;v>s;++s)l+=" "+CSVParser.escapeText(i[s]).replace(/\|/g,"&#124;")+" |"}return l+=n,l=l.replace(/&quot;/g,'"')},trac:function(r,e,a,t,n){var l="",o=r.length,v=e.length,f=[];l+="||";for(var s=0;v>s;++s)l+=" "+e[s]+" ||",f.push(e[s].length+2+("int"===a[s]||"float"===a[s]?"r":""));l+=n+"||";for(var s=0;v>s;++s)l+=(f[s].indexOf("r")<0?CSVParser.repeat("-",f[s]):CSVParser.repeat("-",parseInt(f[s])-1)+":")+"||";for(var c=0;o>c;++c){var i=r[c];l+=n+"||";for(var s=0;v>s;++s)l+=" "+CSVParser.escapeText(i[s]).replace(/\|\|/g,"&#124;")+" ||"}return l+=n,l=l.replace(/&quot;/g,'"')},mysql:function(r,e,a,t,n){var l="",o=r.length,v=e.length;l+="CREATE TABLE "+d.tableName+" ("+n+t+"id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,"+n;for(var f=0;v>f;++f){var s="VARCHAR(255)";("int"===a[f]||"float"===a[f])&&(s=a[f].toUpperCase()),l+=t+e[f]+" "+s,v-1>f&&(l+=","),l+=n}l+=");"+n+"INSERT INTO "+d.tableName+" "+n+t+"(";for(var f=0;v>f;++f)l+=e[f].replace(/\W/g,""),v-1>f&&(l+=",");l+=") "+n+"VALUES "+n;for(var c=0;o>c;++c){l+=t+"(";for(var f=0;v>f;++f)"int"===a[f]||"float"===a[f]?l+=r[c][f]||"NULL":(r[c][f]?r[c][f]=r[c][f].replace(/'/g,"''"):r[c][f]="",l+="'"+r[c][f]+"'"),v-1>f&&(l+=",");l+=")",o-1>c&&(l+=","+n)}return l+=";"+n,l=l.replace(/&quot;/g,'"')},perl:function(r,e,a,t,n){for(var l="(",o=r.length,v=e.length,f=0;o>f;++f){var s=r[f];l+="{";for(var c=0;v>c;++c){if("int"===a[c]||"float"===a[c])var i=s[c]||"undef";else var i='"'+(s[c]||"")+'"';l+='"'+e[c]+'"=>'+i,v-1>c&&(l+=",")}l+="}",o-1>f&&(l+=","+n)}return l+=")"+n,l=l.replace(/&quot;/g,'\\"')},php:function(r,e,a,t,n){for(var l="array("+n,o=r.length,v=e.length,f=0;o>f;++f){var s=r[f];l+=t+"array(";for(var c=0;v>c;++c){if("int"===a[c]||"float"===a[c])var i=s[c]||"NULL";else var i='"'+(s[c]||"")+'"';l+='"'+e[c]+'"=>'+i,v-1>c&&(l+=",")}l+=")",o-1>f&&(l+=","+n)}return l+=n+")"+n,l=l.replace(/&quot;/g,'\\"')},python:function(r,e,a,t,n){for(var l="[",o=r.length,v=e.length,f=0;o>f;++f){var s=r[f];l+="{";for(var c=0;v>c;++c){if("int"===a[c]||"float"===a[c])var i=s[c]||"None";else var i='"'+(s[c]||"")+'"';l+='"'+e[c]+'":'+i,v-1>c&&(l+=",")}l+="}",o-1>f&&(l+=","+n)}return l+="]"+n,l=l.replace(/&quot;/g,'\\"')},rtf:function(r,e,a,t,n){var l="",o=r.length,v=e.length,f="",s=Math.round(9e3/v),c="\\clbrdrt\\brdrs\\clbrdrl\\brdrs\\clbrdrb\\brdrs\\clbrdrr\\brdrs";l+="\\trowd\\trgaph144";for(var i=0;v>i;++i)l+=c+"\\cellx"+s*(i+1);f=l;for(var i=0;v>i;++i)l+="\\pard\\intbl\\qc\\b{"+e[i]+"}\\cell";l+="\\row"+n;for(var g=0;o>g;++g){var u=r[g];l+=f;for(var i=0;v>i;++i)l+="\\pard\\intbl"+("int"===a[i]||"float"===a[i]?"\\qr":"")+"\\plain{"+CSVParser.escapeText(u[i],"rtf")+"}\\cell";l+="\\row"+n}return l=l.replace(/&quot;/g,'"')},ruby:function(r,e,a,t,n){for(var l="[",o=r.length,v=e.length,f=0;o>f;++f){var s=r[f];l+="{";for(var c=0;v>c;++c){if("int"===a[c]||"float"===a[c])var i=s[c]||"nil";else var i='"'+(s[c]||"")+'"';l+='"'+e[c]+'"=>'+i,v-1>c&&(l+=",")}l+="}",o-1>f&&(l+=","+n)}return l+="]"+n,l=l.replace(/&quot;/g,'\\"')},wiki:function(r,e,a,t,n){var l="",o=r.length,v=e.length;l+='{| class="wikitable"'+n+"! ";for(var f=0;v>f;++f)l+='scope="col" | '+e[f],v-1>f&&(l+=" || ");l+=n+"|-"+n;for(var s=0;o>s;++s){var c=r[s];l+="| ";for(var f=0;v>f;++f)l+=("int"===a[f]||"float"===a[f]?'style="text-align:right" | ':"")+CSVParser.escapeText(c[f]).replace(/\|/g,"&#124;"),v-1>f&&(l+=" || ");o-1>s&&(l+=n+"|-"+n)}return l+=n+"|}"+n,l=l.replace(/&quot;/g,'"')},xmlProperties:function(r,e,a,t,n){var l="",o=r.length,v=e.length;l+='<?xml version="1.0" encoding="UTF-8"?>'+n+"<rows>"+n;for(var f=0;o>f;++f){var s=r[f];l+=t+"<row ";for(var c=0;v>c;++c)l+=e[c]+'="'+CSVParser.escapeText(s[c],"xml")+'" ';l+="/>"+n}return l+="</rows>"+n,l=l.replace(/&amp;quot;/g,"&quot;")},xml:function(r,e,a,t,n){var l="",o=r.length,v=e.length;l+='<?xml version="1.0" encoding="UTF-8"?>'+n+"<rows>"+n;for(var f=0;o>f;++f){var s=r[f];l+=t+"<row>"+n;for(var c=0;v>c;++c)s[c]?s[c]=CSVParser.escapeText(s[c],"xml"):s[c]="",e[c]=e[c].replace(/\W/g,""),l+=t+t+"<"+e[c]+">"+s[c]+"</"+e[c]+">"+n;l+=t+"</row>"+n}return l+="</rows>"+n,l=l.replace(/&amp;quot;/g,"&quot;")},xmlIllustrator:function(r,e,a,t,n){var l="",o=r.length,v=e.length;l+='<?xml version="1.0" encoding="utf-8"?>'+n+'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20001102//EN" "http://www.w3.org/TR/2000/CR-SVG-20001102/DTD/svg-20001102.dtd" ['+n+t+'<!ENTITY ns_graphs "http://ns.adobe.com/Graphs/1.0/">'+n+t+'<!ENTITY ns_vars "http://ns.adobe.com/Variables/1.0/">'+n+t+'<!ENTITY ns_imrep "http://ns.adobe.com/ImageReplacement/1.0/">'+n+t+'<!ENTITY ns_custom "http://ns.adobe.com/GenericCustomNamespace/1.0/">'+n+t+'<!ENTITY ns_flows "http://ns.adobe.com/Flows/1.0/">'+n+t+'<!ENTITY ns_extend "http://ns.adobe.com/Extensibility/1.0/">'+n+"]>"+n+"<svg>"+n+t+'<variableSets xmlns="&ns_vars;">'+n+t+t+'<variableSet varSetName="binding1" locked="none">'+n+t+t+t+"<variables>"+n;for(var f=0;v>f;++f)l+=t+t+t+t+'<variable varName="'+e[f]+'" trait="textcontent" category="&ns_flows;"></variable>'+n;l+=t+t+t+"</variables>"+n+t+t+t+'<v:sampleDataSets xmlns:v="http://ns.adobe.com/Variables/1.0/" xmlns="http://ns.adobe.com/GenericCustomNamespace/1.0/">'+n;for(var s=0;o>s;++s){var c=r[s];l+=t+t+t+t+'<v:sampleDataSet dataSetName="'+c[0]+'">'+n;for(var f=0;v>f;++f)e[f]=e[f].replace(/\W/g,""),l+=t+t+t+t+t+"<"+e[f]+"><p>"+CSVParser.escapeText(c[f],"xml")+"</p></"+e[f]+">"+n;l+=t+t+t+t+"</v:sampleDataSet>"+n}return l+=t+t+t+"</v:sampleDataSets>"+n+t+t+"</variableSet>"+n+t+"</variableSets>"+n+"</svg>"+n,l=l.replace(/&amp;quot;/g,"&quot;")},yaml:function(r,e,a,t,n){for(var l="",o=r.length,v=e.length,f=e.sort(function(r,e){return e.length-r.length})[0].length,s=0;o>s;++s)for(var c=r[s],i=0;v>i;++i)l+=(i>0?"  ":"- ")+e[i]+": "+CSVParser.repeat(" ",f-e[i].length)+(c[i]||"")+n;return l=l.replace(/&quot;/g,'"')}};
 /*!
 * Converter.js
 * Mr-Data-Converter
 *
 * Created by Shan Carter on 2010-09-01.
 */
DataConverter.prototype.init=function(){var n=this;this.inputTextArea=$("#data-input");this.outputTextArea=$("#data-output");this.dataSelector=$("#data-selector");$("#converter > .wrapper").append('<div class="loader">  <span class="loader-text">Loading...</span>  <i class="loader-icon"></i></div>');this.outputTextArea.val()&&(n.outputDataType=this.dataSelector.children("option:selected").val(),n.convert());this.inputTextArea.add(this.outputTextArea).click(function(){this.select()});$("#insert-sample").click(function(t){t.preventDefault();n.insertSampleData();n.convert();ga("send","event","SampleData","InsertGeneric")});this.inputTextArea.on({change:function(){n.convert();ga("send","event","DataType",n.outputDataType)},keyup:function(){var t=$(this);t.data("wait")||(t.data("wait",!0),n.convert(),setTimeout(function(){t.data("wait",!1)},500))}});this.dataSelector.change(function(){n.outputDataType=$(this).val();n.convert();n.outputTextArea.select()});$(".loader").remove();this.node.addClass("loaded")};DataConverter.prototype.convert=function(){if(this.inputText=this.inputTextArea.val(),this.inputText.length>0){this.includeWhiteSpace?this.newLine="\n":(this.indent="",this.newLine="");CSVParser.resetLog();var n=CSVParser.parse(this.inputText,this.headersProvided,this.delimiter,this.downcaseHeaders,this.upcaseHeaders,this.decimal),t=n.dataGrid,i=n.headerNames,r=n.headerTypes,u=n.errors;this.outputText=DataGridRenderer[this.outputDataType](t,i,r,this.indent,this.newLine);this.outputTextArea.val(u+this.outputText)}};DataConverter.prototype.insertSampleData=function(){this.inputTextArea.val('NAME\tVALUE\tCOLOR\tDATE\nAlan\t12\tblue\tSep. 25, 2009\nShan\t13\t"green\tblue"\tSep. 27, 2009\nJohn\t45\torange\tSep. 29, 2009\nMinna\t27\tteal\tSep. 30, 2009')};
/*!
 * Controller.js
 */
$(document).ready(function(){function n(n){if(n&&ga("send","event","Settings",n.currentTarget.id),d.includeWhiteSpace=$("#includeWhiteSpaceCB").prop("checked"),d.includeWhiteSpace){$("input[name=indentType]").removeAttr("disabled");switch($("input[name=indentType]:checked").val()){case"spaces":d.indent="  ";break;case"tabs":d.indent="\t"}}else $("input[name=indentType]").prop("disabled",!0);if(d.headersProvided=$("#headersProvidedCB").prop("checked"),d.headersProvided){$("input[name=headerModifications]").removeAttr("disabled");switch($("input[name=headerModifications]:checked").val()){case"none":d.downcaseHeaders=!1;d.upcaseHeaders=!1;break;case"downcase":d.downcaseHeaders=!0;d.upcaseHeaders=!1;break;case"upcase":d.downcaseHeaders=!1;d.upcaseHeaders=!0}}else $("input[name=headerModifications]").prop("disabled",!0);d.delimiter=$("input[name=delimiter]:checked").val();d.decimal=$("input[name=decimal]:checked").val();d.convert()}d=new DataConverter("converter");d.init();$(".settings-element").change(n);n()});